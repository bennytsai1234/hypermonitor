# Hyperliquid Monitor å®Œæ•´éƒ¨ç½²æŒ‡å—

é€™ä»½æŒ‡å—å°‡æ•™æ‚¨å¦‚ä½•å°‡ Hyperliquid Monitor çš„å¾Œç«¯ (API Worker) èˆ‡å‰ç«¯ (PWA) éƒ¨ç½²åˆ°æ‚¨è‡ªå·±çš„ Cloudflare å¸³æˆ¶ä¸Šï¼Œå®Œå…¨ç¨ç«‹é‹è¡Œã€‚

---

## ğŸ“‹ äº‹å‰æº–å‚™

1.  **Cloudflare å¸³æˆ¶**: è«‹å…ˆè¨»å†Š [Cloudflare](https://dash.cloudflare.com/) å¸³è™Ÿã€‚
2.  **Node.js**: å®‰è£ [Node.js](https://nodejs.org/) (å»ºè­° v18+)ã€‚
3.  **Wrangler CLI**: Cloudflare çš„é–‹ç™¼å·¥å…·ã€‚
    ```bash
    npm install -g wrangler
    ```
4.  **ç™»å…¥ Cloudflare**:
    ```bash
    npx wrangler login
    ```
    (ç€è¦½å™¨æœƒå½ˆå‡ºï¼Œè«‹æˆæ¬Šç™»å…¥)

---

## â˜ï¸ ç¬¬ä¸€æ­¥ï¼šéƒ¨ç½²å¾Œç«¯ (Cloudflare Worker)

é€™å€‹ Worker è² è²¬å¾ Coinglass æŠ“å–æ•¸æ“šä¸¦æä¾› API çµ¦å‰ç«¯ã€‚

1.  **é€²å…¥ worker ç›®éŒ„**
    é–‹å•Ÿçµ‚ç«¯æ©Ÿ (Terminal / Cmd) ä¸¦é€²å…¥å°ˆæ¡ˆçš„ worker è³‡æ–™å¤¾ï¼š
    ```bash
    cd worker
    ```

2.  **å®‰è£ä¾è³´**
    ```bash
    npm install
    ```

3.  **å»ºç«‹ D1 è³‡æ–™åº«**
    æˆ‘å€‘éœ€è¦ä¸€å€‹è³‡æ–™åº«ä¾†å„²å­˜æ­·å²æ•¸æ“šã€‚
    ```bash
    npx wrangler d1 create hyper-monitor-db
    ```
    ğŸš¨ **é‡è¦**ï¼šåŸ·è¡Œå¾Œï¼Œçµ‚ç«¯æ©Ÿæœƒé¡¯ç¤ºä¸€æ®µ `[[d1_databases]]` çš„é…ç½®ã€‚è«‹è¤‡è£½é€™æ®µå…§å®¹ï¼Œè²¼åˆ° `worker/wrangler.toml` æª”æ¡ˆä¸­ï¼Œå–ä»£èˆŠçš„è³‡æ–™åº«è¨­å®š (è‹¥æœ‰çš„è©±ï¼Œæˆ–ç¢ºèª `database_id` æ˜¯å¦ä¸€è‡´)ã€‚

4.  **åˆå§‹åŒ–è³‡æ–™åº«çµæ§‹**
    ```bash
    npx wrangler d1 execute hyper-monitor-db --file=./schema.sql --remote
    ```

5.  **éƒ¨ç½² Worker**
    ```bash
    npx wrangler deploy
    ```
    éƒ¨ç½²æˆåŠŸå¾Œï¼Œæ‚¨æœƒçœ‹åˆ°ä¸€å€‹ç¶²å€ï¼Œä¾‹å¦‚ï¼š
    `https://hyper-monitor-worker.æ‚¨çš„å¸³è™Ÿ.workers.dev`

    ğŸ‘‰ **è«‹è¤‡è£½é€™å€‹ç¶²å€ï¼Œä¸‹ä¸€æ­¥æœƒç”¨åˆ°ï¼**

---

## ğŸ“± ç¬¬äºŒæ­¥ï¼šé€£æ¥å‰ç«¯ (PWA)

ç¾åœ¨æˆ‘å€‘è¦è®“ PWA é€£æ¥æ‚¨å‰›å‰›éƒ¨ç½²çš„ APIã€‚

1.  **å›åˆ°å°ˆæ¡ˆæ ¹ç›®éŒ„**
2.  **ä¿®æ”¹é…ç½®æª”æ¡ˆ**
    æ‰“é–‹ `pwa/js/config.js` æª”æ¡ˆã€‚

    æ‰¾åˆ°é€™è¡Œï¼š
    ```javascript
    export const API_BASE = 'https://hyper-monitor-worker.bennytsai0711.workers.dev';
    ```

    å°‡å¼•è™Ÿå…§çš„ç¶²å€æ›æˆæ‚¨å‰›å‰›ç²å¾—çš„ Worker ç¶²å€ã€‚

    ```javascript
    // ç¯„ä¾‹ï¼šæ›æˆæ‚¨çš„
    export const API_BASE = 'https://hyper-monitor-worker.æ‚¨çš„åå­—.workers.dev';
    ```

3.  **æ¸¬è©¦é€£ç·š (é¸ç”¨)**
    æ‚¨å¯ä»¥åœ¨æœ¬åœ°æ‰“é–‹ `pwa/index.html` (ä½¿ç”¨ Live Server æˆ– `python -m http.server`)ï¼Œçœ‹çœ‹æ•¸æ“šæ˜¯å¦èƒ½æ­£å¸¸è¼‰å…¥ã€‚

---

## ğŸš€ ç¬¬ä¸‰æ­¥ï¼šéƒ¨ç½²å‰ç«¯ (Cloudflare Pages)

æœ€å¾Œï¼Œå°‡ PWA ä»‹é¢éƒ¨ç½²åˆ°ç¶²è·¯ä¸Šã€‚

1.  **åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„åŸ·è¡Œ**
    ```bash
    .\scripts\deploy_pwa.bat
    ```

    (æˆ–è€…æ˜¯æ‰‹å‹•åŸ·è¡Œ `npx wrangler pages deploy pwa --project-name=hyper-monitor`)

2.  **å®Œæˆï¼**
    çµ‚ç«¯æ©Ÿæœƒé¡¯ç¤ºæ‚¨çš„ PWA ç¶²å€ï¼Œä¾‹å¦‚ï¼š
    `https://hyper-monitor.pages.dev`

    æ‚¨ç¾åœ¨å¯ä»¥ç”¨æ‰‹æ©Ÿæˆ–é›»è…¦ç€è¦½å™¨æ‰“é–‹é€™å€‹ç¶²å€ã€‚

---

## ğŸ”„ å¦‚ä½•æ›´æ–°ï¼Ÿ

### æ›´æ–°å¾Œç«¯ä»£ç¢¼
1.ä¿®æ”¹ `worker/src` å…§çš„ä»£ç¢¼ã€‚
2.åŸ·è¡Œ `cd worker && npx wrangler deploy`ã€‚

### æ›´æ–°å‰ç«¯ä»‹é¢
1.ä¿®æ”¹ `pwa/` å…§çš„ä»£ç¢¼ (å¦‚ JS, CSS)ã€‚
2.è‹¥æœ‰ä¿®æ”¹é‚è¼¯ï¼Œå»ºè­°æ›´æ–° `pwa/sw.js` å…§çš„ç‰ˆæœ¬è™Ÿ (`CACHE_NAME`) ä»¥å¼·åˆ¶ç”¨æˆ¶ç«¯æ›´æ–°ã€‚
3.åœ¨æ ¹ç›®éŒ„åŸ·è¡Œ `.\scripts\deploy_pwa.bat`ã€‚

---

## ğŸ å¸¸è¦‹å•é¡Œ

**Q: PWA æ‰“é–‹å¾Œä¸€ç›´è½‰åœˆåœˆ (Loading...)ï¼Ÿ**
A: æª¢æŸ¥ `pwa/js/config.js` çš„ `API_BASE` æ˜¯å¦æ­£ç¢ºã€‚æ‚¨å¯ä»¥åœ¨ç€è¦½å™¨ Console (F12) çœ‹åˆ°æ˜¯å¦æœ‰é€£ç·šéŒ¯èª¤ (CORS æˆ– 404)ã€‚

**Q: æ‰‹æ©Ÿä¸Šçœ‹ä¸åˆ°æ–°åŠŸèƒ½ï¼Ÿ**
A: PWA æœ‰ç·©å­˜æ©Ÿåˆ¶ã€‚è«‹å®Œå…¨é—œé–‰åˆ†é é‡é–‹ï¼Œæˆ–åœ¨è¨­å®šä¸­æ¸…é™¤ç¶²ç«™è³‡æ–™ã€‚è‹¥æ‚¨æ˜¯é–‹ç™¼è€…ï¼Œè«‹ç¢ºä¿ `sw.js` ç‰ˆæœ¬è™Ÿå·²æ›´æ–°ä¸¦é‡æ–°éƒ¨ç½²ã€‚

**Q: Worker å ±éŒ¯ "D1_ERROR"ï¼Ÿ**
A: ç¢ºä¿æ­¥é©Ÿ 3 çš„è³‡æ–™åº« ID æ­£ç¢ºå¡«å…¥ `wrangler.toml`ï¼Œä¸”æ­¥é©Ÿ 4 çš„ schema å·²æˆåŠŸåŸ·è¡Œã€‚
